import { useState } from 'react';

export default function FoodSwipeApp() {
  const [currentIndex, setCurrentIndex] = useState(0);
  const [startX, setStartX] = useState(null);
  const [offsetX, setOffsetX] = useState(0);
  const [isAnimating, setIsAnimating] = useState(false);

  const foods = [
    {
      id: 1,
      name: "Phở Bò",
      description: "Món súp truyền thống Việt Nam với bánh phở, thịt bò và nước dùng thơm ngon",
      image: "/api/placeholder/400/300"
    },
    {
      id: 2,
      name: "Bánh Mì",
      description: "Bánh mì giòn với các loại nhân thịt, rau và nước sốt đặc trưng",
      image: "/api/placeholder/400/300"
    },
    {
      id: 3,
      name: "Gỏi Cuốn",
      description: "Cuốn tươi với tôm, thịt heo, bún và rau thơm, chấm cùng nước mắm",
      image: "/api/placeholder/400/300"
    },
    {
      id: 4,
      name: "Bún Chả",
      description: "Bún ăn kèm thịt lợn nướng, rau sống và nước mắm chua ngọt",
      image: "/api/placeholder/400/300"
    },
    {
      id: 5,
      name: "Cơm Tấm",
      description: "Cơm tấm sườn nướng cùng trứng ốp la và đồ chua",
      image: "/api/placeholder/400/300"
    }
  ];

  const handleTouchStart = (e) => {
    setStartX(e.touches[0].clientX);
  };

  const handleTouchMove = (e) => {
    if (startX === null) return;
    const currentX = e.touches[0].clientX;
    const diff = currentX - startX;
    setOffsetX(diff);
  };

  const handleTouchEnd = () => {
    if (offsetX > 100 && currentIndex > 0) {
      // Swipe right - go to previous
      animateSwipe('right');
    } else if (offsetX < -100 && currentIndex < foods.length - 1) {
      // Swipe left - go to next
      animateSwipe('left');
    } else {
      // Reset position
      setOffsetX(0);
    }
    setStartX(null);
  };

  const animateSwipe = (direction) => {
    setIsAnimating(true);
    
    if (direction === 'left') {
      setOffsetX(-300);
      setTimeout(() => {
        setCurrentIndex(currentIndex + 1);
        setOffsetX(0);
        setIsAnimating(false);
      }, 300);
    } else {
      setOffsetX(300);
      setTimeout(() => {
        setCurrentIndex(currentIndex - 1);
        setOffsetX(0);
        setIsAnimating(false);
      }, 300);
    }
  };

  const goToFood = (index) => {
    setCurrentIndex(index);
  };

  return (
    <div className="flex flex-col items-center max-w-lg mx-auto p-4 h-screen">
      <h1 className="text-2xl font-bold mb-6">Khám Phá Món Ăn</h1>
      
      <div className="relative w-full h-96 overflow-hidden rounded-lg shadow-lg mb-4">
        <div 
          className={`absolute w-full h-full transition-transform duration-300 ${isAnimating ? 'ease-out' : ''}`}
          style={{ transform: `translateX(${offsetX}px)` }}
          onTouchStart={handleTouchStart}
          onTouchMove={handleTouchMove}
          onTouchEnd={handleTouchEnd}
        >
          <img 
            src={foods[currentIndex].image} 
            alt={foods[currentIndex].name}
            className="w-full h-64 object-cover"
          />
          <div className="p-4 bg-white">
            <h2 className="text-xl font-semibold">{foods[currentIndex].name}</h2>
            <p className="text-gray-600 mt-2">{foods[currentIndex].description}</p>
          </div>
        </div>
      </div>
      
      <div className="flex justify-between items-center w-full mb-4">
        <button 
          onClick={() => currentIndex > 0 && animateSwipe('right')}
          className={`px-4 py-2 bg-blue-500 text-white rounded-lg ${currentIndex === 0 ? 'opacity-50 cursor-not-allowed' : ''}`}
          disabled={currentIndex === 0}
        >
          Trước
        </button>
        
        <span className="text-gray-600">
          {currentIndex + 1} / {foods.length}
        </span>
        
        <button 
          onClick={() => currentIndex < foods.length - 1 && animateSwipe('left')}
          className={`px-4 py-2 bg-blue-500 text-white rounded-lg ${currentIndex === foods.length - 1 ? 'opacity-50 cursor-not-allowed' : ''}`}
          disabled={currentIndex === foods.length - 1}
        >
          Tiếp
        </button>
      </div>
      
      <div className="flex space-x-2 mt-2">
        {foods.map((_, index) => (
          <button
            key={index}
            onClick={() => goToFood(index)}
            className={`w-3 h-3 rounded-full ${index === currentIndex ? 'bg-blue-500' : 'bg-gray-300'}`}
          />
        ))}
      </div>
    </div>
  );
}
