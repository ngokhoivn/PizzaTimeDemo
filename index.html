<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pizza Time - Đặt Hàng</title>
    <style>
        :root {
            --primary-color: #ff4b4b;
            --secondary-color: #4285f4;
            --text-color: #333;
            --text-light: #666;
            --background-color: #f8f9fa;
            --white: #ffffff;
            --border-radius: 12px;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --spacing-xs: 4px;
            --spacing-sm: 8px;
            --spacing-md: 16px;
            --spacing-lg: 24px;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--background-color);
            color: var(--text-color);
            padding: var(--spacing-md);
            max-width: 100%;
            margin: 0 auto;
            padding-bottom: 80px; /* Space for cart button */
        }

        h1 {
            text-align: center;
            margin-bottom: var(--spacing-md);
            font-size: 24px;
            color: var(--primary-color);
        }

        /* Timeline styles */
        .timeline {
            margin-bottom: var(--spacing-lg);
        }

        .timeline-container {
            display: flex;
            overflow-x: auto;
            padding: var(--spacing-sm) 0;
            scroll-snap-type: x mandatory;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none; /* Firefox */
        }

            .timeline-container::-webkit-scrollbar {
                display: none; /* Chrome, Safari, Edge */
            }

        .timeline-item {
            flex: 0 0 auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-right: var(--spacing-md);
            cursor: pointer;
            scroll-snap-align: start;
            transition: transform 0.2s;
            padding: var(--spacing-xs);
        }

            .timeline-item:active {
                transform: scale(0.95);
            }

        .timeline-image {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid #ddd;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .timeline-item.active .timeline-image {
            border: 2px solid var(--primary-color);
        }

        .timeline-name {
            margin-top: var(--spacing-xs);
            font-size: 12px;
            text-align: center;
            color: var(--text-light);
            max-width: 70px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .timeline-item.active .timeline-name {
            color: var(--primary-color);
            font-weight: bold;
        }

        /* Section title */
        .section-title {
            font-size: 18px;
            margin: var(--spacing-lg) 0 var(--spacing-sm);
            color: var(--text-color);
            border-left: 4px solid var(--primary-color);
            padding-left: var(--spacing-sm);
            display: flex;
            align-items: center;
        }

        /* Common styles for all swipeable sections */
        .swipe-container {
            position: relative;
            width: 100%;
            overflow: hidden;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            margin-bottom: var(--spacing-sm);
            background-color: var(--white);
        }

        /* Combo section */
        .combo-container {
            height: 300px;
            margin-bottom: 0;
        }

        .food-card {
            position: absolute;
            width: 100%;
            height: 100%;
            transition: transform 0.3s ease-out;
            background-color: var(--white);
        }

            .food-card img {
                width: 100%;
                height: 160px;
                object-fit: cover;
                border-top-left-radius: var(--border-radius);
                border-top-right-radius: var(--border-radius);
            }

        .food-info {
            padding: var(--spacing-md);
        }

            .food-info h2 {
                font-size: 18px;
                margin-bottom: var(--spacing-sm);
                color: var(--text-color);
            }

            .food-info p {
                color: var(--text-light);
                line-height: 1.4;
                font-size: 14px;
            }

        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: var(--spacing-xs) 0 var(--spacing-md);
        }

        button {
            padding: var(--spacing-sm) var(--spacing-md);
            background-color: var(--secondary-color);
            color: var(--white);
            border: none;
            border-radius: var(--spacing-sm);
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 70px;
            height: 36px;
        }

            button:active {
                transform: scale(0.97);
            }

            button:hover {
                background-color: #3367d6;
            }

            button:disabled {
                opacity: 0.5;
                cursor: not-allowed;
            }

        .counter {
            font-size: 14px;
            color: var(--text-light);
        }

        .indicators {
            display: flex;
            justify-content: center;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-md);
        }

        .dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #ddd;
            cursor: pointer;
            transition: transform 0.2s, background-color 0.2s;
        }

            .dot.active {
                background-color: var(--primary-color);
                width: 10px;
                height: 10px;
            }

            .dot:active {
                transform: scale(1.2);
            }

        /* Food items styles */
        .food-section {
            margin-top: var(--spacing-lg);
        }

        .food-slide-container {
            height: 170px;
            margin-bottom: 0;
        }

        .food-slide {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            transition: transform 0.3s ease-out;
        }

        .food-group {
            position: absolute;
            width: 100%;
            height: 100%;
            transition: transform 0.3s ease-out;
        }

        .food-item {
            flex: 0 0 33.333%;
            padding: var(--spacing-xs);
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

            .food-item img {
                width: 100%;
                aspect-ratio: 1/1;
                object-fit: cover;
                border-radius: var(--spacing-sm);
                box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }

        .food-item-name {
            margin-top: var(--spacing-xs);
            font-size: 12px;
            text-align: center;
            color: var(--text-color);
            max-width: 100%;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .quantity-control {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: var(--spacing-xs);
        }

        .quantity-btn {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background-color: var(--primary-color);
            color: var(--white);
            border: none;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: transform 0.2s;
        }

            .quantity-btn:active {
                transform: scale(0.9);
            }

            .quantity-btn:disabled {
                background-color: #ccc;
            }

        .quantity {
            margin: 0 var(--spacing-sm);
            font-size: 14px;
            min-width: 20px;
            text-align: center;
            font-weight: bold;
        }

        /* Cart button */
        .cart-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: var(--primary-color);
            color: var(--white);
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            z-index: 100;
            transition: transform 0.3s;
        }

            .cart-button:active {
                transform: scale(0.95);
            }

        .cart-count {
            position: absolute;
            top: -5px;
            right: -5px;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background-color: var(--secondary-color);
            color: var(--white);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 12px;
            font-weight: bold;
            border: 2px solid var(--white);
        }

        .cart-icon {
            font-size: 24px;
        }

        /* Progress bar for swiping gestures */
        .swipe-progress {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background-color: rgba(0,0,0,0.1);
        }

        .swipe-progress-inner {
            height: 100%;
            background-color: var(--primary-color);
            width: 0%;
            transition: width 0.3s;
        }

        /* Loader for better UX */
        .loader {
            text-align: center;
            padding: var(--spacing-lg);
            display: none;
        }

        .loader-spinner {
            display: inline-block;
            width: 30px;
            height: 30px;
            border: 3px solid rgba(0,0,0,0.1);
            border-radius: 50%;
            border-top-color: var(--primary-color);
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* Add a badge for popular items */
        .badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: var(--primary-color);
            color: white;
            font-size: 10px;
            padding: 3px 6px;
            border-radius: 10px;
            z-index: 1;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        /* Toast notification */
        .toast {
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0,0,0,0.8);
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 14px;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s;
        }

            .toast.show {
                opacity: 1;
            }
    </style>
</head>
<body>
    <h1>Pizza Time - Đặt Hàng</h1>

    <!-- Loading indicator -->
    <div class="loader" id="loader">
        <div class="loader-spinner"></div>
    </div>

    <!-- Timeline của cửa hàng -->
    <div class="timeline">
        <div class="timeline-container" id="timeline">
            <!-- Timeline items will be dynamically inserted here -->
        </div>
    </div>

    <!-- Combo/Ưu đãi đang bán chạy -->
    <h2 class="section-title">Combo Đang Hot</h2>
    <div class="swipe-container combo-container" id="comboContainer">
        <!-- Combo cards will be dynamically inserted here -->
        <div class="swipe-progress">
            <div class="swipe-progress-inner" id="comboProgress"></div>
        </div>
    </div>

    <div class="controls">
        <button id="comboPrevBtn" disabled>← Trước</button>
        <span class="counter" id="comboCounter">1 / 5</span>
        <button id="comboNextBtn">Tiếp →</button>
    </div>

    <div class="indicators" id="comboIndicators">
        <!-- Dots will be dynamically inserted here -->
    </div>

    <!-- Món chính -->
    <h2 class="section-title">Món Chính</h2>
    <div class="swipe-container food-slide-container" id="mainDishContainer">
        <!-- Main dish items will be dynamically inserted here -->
        <div class="swipe-progress">
            <div class="swipe-progress-inner" id="mainDishProgress"></div>
        </div>
    </div>
    <div class="controls">
        <button id="mainDishPrevBtn" disabled>← Trước</button>
        <button id="mainDishNextBtn">Tiếp →</button>
    </div>

    <!-- Danh sách món ăn nhẹ -->
    <h2 class="section-title">Món Ăn Nhẹ</h2>
    <div class="swipe-container food-slide-container" id="snackContainer">
        <!-- Snack items will be dynamically inserted here -->
        <div class="swipe-progress">
            <div class="swipe-progress-inner" id="snackProgress"></div>
        </div>
    </div>
    <div class="controls">
        <button id="snackPrevBtn" disabled>← Trước</button>
        <button id="snackNextBtn">Tiếp →</button>
    </div>

    <!-- Nước uống -->
    <h2 class="section-title">Nước Uống</h2>
    <div class="swipe-container food-slide-container" id="drinkContainer">
        <!-- Drink items will be dynamically inserted here -->
        <div class="swipe-progress">
            <div class="swipe-progress-inner" id="drinkProgress"></div>
        </div>
    </div>
    <div class="controls">
        <button id="drinkPrevBtn" disabled>← Trước</button>
        <button id="drinkNextBtn">Tiếp →</button>
    </div>

    <!-- Nút giỏ hàng -->
    <div class="cart-button" id="cartBtn">
        <span class="cart-count" id="cartCount">0</span>
        <span class="cart-icon">🛒</span>
    </div>

    <!-- Toast notification -->
    <div class="toast" id="toast"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Dữ liệu cửa hàng cho timeline
            const stores = [
                { id: 1, name: "Pizza Time Diên Hồng", image: "/api/placeholder/60/60" },
                { id: 2, name: "Pizza Time Nguyễn Huệ", image: "/api/placeholder/60/60" },
                { id: 3, name: "Pizza Time Hà Thanh", image: "/api/placeholder/60/60" },
                { id: 4, name: "Pizza Time Tuy Hòa", image: "/api/placeholder/60/60" },
                { id: 5, name: "Pizza Time Nha Trang", image: "/api/placeholder/60/60" },
                { id: 6, name: "Pizza Time Đà Nẵng", image: "/api/placeholder/60/60" }
            ];

            // Dữ liệu combo
            const combos = [
                {
                    id: 1,
                    name: "Combo Siêu Tiết Kiệm",
                    description: "1 Pizza (size M) + 2 Nước ngọt + 1 Khoai tây chiên chỉ 149K",
                    image: "images/Combo/Combo1.jfif"
                },
                {
                    id: 2,
                    name: "Combo Gia Đình",
                    description: "2 Pizza (size L) + 4 Nước ngọt + 2 Danh sách món ăn kèm chỉ 299K",
                    image: "images/Combo/Combo2.jpg"
                },
                {
                    id: 3,
                    name: "Combo Đôi",
                    description: "1 Pizza (size M) + 2 Nước ngọt + 1 Bánh mì bơ tỏi chỉ 169K",
                    image: "images/Combo/Combo7.jpg"
                },
                {
                    id: 4,
                    name: "Combo Party",
                    description: "3 Pizza (size L) + 6 Nước ngọt + 3 Danh sách món ăn kèm chỉ 459K",
                    image: "images/Combo/Combo8.jpg"
                },
                {
                    id: 5,
                    name: "Combo Lễ Siêu Tiết Kiệm",
                    description: "Giảm ngay 30% cho tất cả các đơn từ 200K",
                    image: "images/Combo/Combo2.jpg"
                }
            ];

            // Dữ liệu món chính
            const mainDishes = [
                { id: 1, name: "Pizza Hải Sản", price: 89000, image: "images/MainDishes/PepperoniPizza.jpg" },
                { id: 2, name: "Pizza Bò", price: 79000, image: "images/MainDishes/PizzaCaNgu.jpg" },
                { id: 3, name: "Pizza Gà", price: 75000, image: "images/MainDishes/PepperoniPizza.jpg" },
                { id: 4, name: "Pizza Rau Củ", price: 69000, image: "images/MainDishes/PizzaCaNgu.jpg" },
                { id: 5, name: "Pizza Thập Cẩm", price: 89000, image: "images/MainDishes/PepperoniPizza.jpg" },
                { id: 6, name: "Pizza Hawaii", price: 85000, image: "images/MainDishes/PizzaCaNgu.jpg" },
                { id: 7, name: "Pizza Bacon", price: 89000, image: "images/MainDishes/PepperoniPizza.jpg" },
                { id: 8, name: "Pizza Tôm", price: 89000, image: "images/MainDishes/PizzaCaNgu.jpg" },
                { id: 9, name: "Pizza Ý", price: 95000, image: "images/MainDishes/PepperoniPizza.jpg" }
            ];

            // Dữ liệu món ăn nhẹ
            const snacks = [
                { id: 1, name: "Khoai Tây Chiên", price: 39000, image: "images/Snacks/khoai_tay_chien.jfif" },
                { id: 2, name: "Mì Ý Đút Lò", price: 29000, image: "images/Snacks/mi_y_dut_lo.jpg" },
                { id: 3, name: "Gà Sốt Cay", price: 59000, image: "images/Snacks/ga_sot_cay.webp" },
                { id: 4, name: "Salad Cá Ngừ", price: 35000, image: "images/Snacks/salad_ca_ngu.jfif" },
                { id: 5, name: "Tok Lắc Phô Mai", price: 65000, image: "images/Snacks/tok_lac_pho_mai.jpg" },
                { id: 6, name: "Xúc Xích", price: 45000, image: "images/Snacks/banh_mi_bo_toi.jfif" }
            ];

            // Dữ liệu nước uống
            const drinks = [
                { id: 1, name: "Coca Cola", price: 15000, image: "images/Drinks/cocacola.webp" },
                { id: 2, name: "Pepsi", price: 15000, image: "images/Drinks/pepsi.webp" },
                { id: 3, name: "Sprite", price: 15000, image: "images/Drinks/sprite.webp" },
                { id: 4, name: "Fanta", price: 15000, image: "images/Drinks/fanta.jpg" },
                { id: 5, name: "Trà Đào", price: 25000, image: "images/Drinks/tradao.avif" },
                { id: 6, name: "Trà Chanh", price: 20000, image: "images/Drinks/trachanh.avif" },
                { id: 7, name: "Nước Suối", price: 10000, image: "images/Drinks/nuocsuoi.jpg" },
                { id: 8, name: "Nước Cam", price: 25000, image: "images/Drinks/nuoccam.jpg" }
            ];

            // Biến giỏ hàng
            let cart = [];
            const cartCount = document.getElementById('cartCount');

            // Biến toàn cục cho timeline
            const timeline = document.getElementById('timeline');
            let activeStoreId = 1;

            // Biến toàn cục cho combo
            let currentComboIndex = 0;
            const comboContainer = document.getElementById('comboContainer');
            const comboPrevBtn = document.getElementById('comboPrevBtn');
            const comboNextBtn = document.getElementById('comboNextBtn');
            const comboCounter = document.getElementById('comboCounter');
            const comboIndicators = document.getElementById('comboIndicators');

            // Biến toàn cục cho món chính
            let currentMainDishIndex = 0;
            const mainDishContainer = document.getElementById('mainDishContainer');
            const mainDishSlide = document.getElementById('mainDishSlide');
            const mainDishPrevBtn = document.getElementById('mainDishPrevBtn');
            const mainDishNextBtn = document.getElementById('mainDishNextBtn');

            // Biến toàn cục cho món ăn nhẹ
            let currentSnackIndex = 0;
            const snackContainer = document.getElementById('snackContainer');
            const snackSlide = document.getElementById('snackSlide');
            const snackPrevBtn = document.getElementById('snackPrevBtn');
            const snackNextBtn = document.getElementById('snackNextBtn');

            // Biến toàn cục cho nước uống
            let currentDrinkIndex = 0;
            const drinkContainer = document.getElementById('drinkContainer');
            const drinkSlide = document.getElementById('drinkSlide');
            const drinkPrevBtn = document.getElementById('drinkPrevBtn');
            const drinkNextBtn = document.getElementById('drinkNextBtn');

            // Khởi tạo timeline
            function initTimeline() {
                timeline.innerHTML = '';
                stores.forEach(store => {
                    const timelineItem = document.createElement('div');
                    timelineItem.className = `timeline-item ${store.id === activeStoreId ? 'active' : ''}`;
                    timelineItem.dataset.id = store.id;

                    timelineItem.innerHTML = `
                    <img src="${store.image}" alt="${store.name}" class="timeline-image">
                    <div class="timeline-name">${store.name}</div>
                `;

                    timelineItem.addEventListener('click', () => {
                        activeStoreId = store.id;
                        updateTimeline();
                    });

                    timeline.appendChild(timelineItem);
                });
            }

            // Cập nhật timeline
            function updateTimeline() {
                const timelineItems = document.querySelectorAll('.timeline-item');
                timelineItems.forEach(item => {
                    if (parseInt(item.dataset.id) === activeStoreId) {
                        item.classList.add('active');
                    } else {
                        item.classList.remove('active');
                    }
                });
            }

            // Khởi tạo thẻ combo
            function initComboCards() {
                comboContainer.innerHTML = '';
                combos.forEach((combo, index) => {
                    const card = document.createElement('div');
                    card.className = 'food-card';
                    card.style.transform = `translateX(${(index - currentComboIndex) * 100}%)`;

                    card.innerHTML = `
                    <img src="${combo.image}" alt="${combo.name}">
                    <div class="food-info">
                        <h2>${combo.name}</h2>
                        <p>${combo.description}</p>
                    </div>
                `;

                    comboContainer.appendChild(card);
                });

                updateComboUI();
                initComboIndicators();
            }

            // Khởi tạo điểm chỉ báo combo
            function initComboIndicators() {
                comboIndicators.innerHTML = '';
                combos.forEach((_, index) => {
                    const dot = document.createElement('div');
                    dot.className = `dot ${index === currentComboIndex ? 'active' : ''}`;
                    dot.addEventListener('click', () => goToCombo(index));
                    comboIndicators.appendChild(dot);
                });
            }

            // Cập nhật giao diện combo
            function updateComboUI() {
                // Cập nhật chỉ báo
                const dots = document.querySelectorAll('.dot');
                dots.forEach((dot, index) => {
                    dot.className = `dot ${index === currentComboIndex ? 'active' : ''}`;
                });

                // Cập nhật nút
                comboPrevBtn.disabled = currentComboIndex === 0;
                comboNextBtn.disabled = currentComboIndex === combos.length - 1;

                // Cập nhật bộ đếm
                comboCounter.textContent = `${currentComboIndex + 1} / ${combos.length}`;

                // Cập nhật vị trí thẻ
                const cards = document.querySelectorAll('.food-card');
                cards.forEach((card, index) => {
                    card.style.transform = `translateX(${(index - currentComboIndex) * 100}%)`;
                });
            }

            // Chuyển đến combo cụ thể
            function goToCombo(index) {
                currentComboIndex = index;
                updateComboUI();
            }

            // Chuyển đến combo trước
            function goToPrevCombo() {
                if (currentComboIndex > 0) {
                    currentComboIndex--;
                    updateComboUI();
                }
            }

            // Chuyển đến combo tiếp theo
            function goToNextCombo() {
                if (currentComboIndex < combos.length - 1) {
                    currentComboIndex++;
                    updateComboUI();
                }
            }

            // Xử lý sự kiện vuốt cho combo
            function handleComboTouchStart(e) {
                window.comboStartX = e.touches[0].clientX;
            }

            function handleComboTouchMove(e) {
                if (!window.comboStartX) return;

                const currentX = e.touches[0].clientX;
                const diffX = currentX - window.comboStartX;

                const cards = document.querySelectorAll('.food-card');
                cards.forEach((card, index) => {
                    // Giới hạn chuyển động để không vượt quá đầu/cuối
                    let translateX = (index - currentComboIndex) * 100 + (diffX / 10); // Giảm độ nhạy
                    if (currentComboIndex === 0 && diffX > 0) {
                        translateX = Math.min(translateX, 0); // Không cho kéo qua trái đầu danh sách
                    }
                    if (currentComboIndex === combos.length - 1 && diffX < 0) {
                        translateX = Math.max(translateX, (index - currentComboIndex) * 100); // Không cho kéo qua phải cuối danh sách
                    }
                    card.style.transform = `translateX(${translateX}%)`;
                });
            }

            function handleComboTouchEnd(e) {
                if (!window.comboStartX) return;

                const currentX = e.changedTouches[0].clientX;
                const diffX = currentX - window.comboStartX;

                // Tăng ngưỡng để tránh nhảy quá nhanh
                if (diffX < -100 && currentComboIndex < combos.length - 1) { // Ngưỡng -100 thay vì -50
                    goToNextCombo();
                } else if (diffX > 100 && currentComboIndex > 0) { // Ngưỡng 100 thay vì 50
                    goToPrevCombo();
                } else {
                    updateComboUI(); // Quay lại vị trí hợp lệ
                }

                window.comboStartX = null;
            }

            // Khởi tạo món chính
            function initMainDishes() {
                mainDishContainer.innerHTML = '';

                for (let i = 0; i < mainDishes.length; i += 3) {
                    const group = document.createElement('div');
                    group.className = 'food-group';
                    group.style.display = 'flex';
                    group.style.width = '100%';

                    for (let j = i; j < i + 3 && j < mainDishes.length; j++) {
                        const dish = mainDishes[j];
                        const foodItem = document.createElement('div');
                        foodItem.className = 'food-item';

                        foodItem.innerHTML = `
                    <img src="${dish.image}" alt="${dish.name}">
                    <div class="food-item-name">${dish.name}</div>
                    <div class="quantity-control">
                        <button class="quantity-btn minus" data-id="${dish.id}">-</button>
                        <span class="quantity" id="main-qty-${dish.id}">0</span>
                        <button class="quantity-btn plus" data-id="${dish.id}">+</button>
                    </div>
                `;

                        const minusBtn = foodItem.querySelector('.minus');
                        const plusBtn = foodItem.querySelector('.plus');

                        minusBtn.addEventListener('click', () => decreaseQuantity('main', dish.id));
                        plusBtn.addEventListener('click', () => increaseQuantity('main', dish.id, dish.name, dish.price));

                        group.appendChild(foodItem);
                    }

                    mainDishContainer.appendChild(group);
                }

                mainDishSlide.style.width = `${Math.ceil(mainDishes.length / 3) * 100}%`;
                updateMainDishPosition();
            }


            // Cập nhật vị trí món chính
            function updateMainDishUI() {
                const groups = mainDishContainer.querySelectorAll('.food-group');
                groups.forEach((group, index) => {
                    group.style.transform = `translateX(${(index - currentMainDishIndex) * 100}%)`;
                });

                // Cập nhật trạng thái nút bấm
                mainDishPrevBtn.disabled = (currentMainDishIndex === 0);
                mainDishNextBtn.disabled = (currentMainDishIndex === groups.length - 1);
            }

            function updateSnackUI() {
                const groups = snackContainer.querySelectorAll('.food-group');
                groups.forEach((group, index) => {
                    group.style.transform = `translateX(${(index - currentSnackIndex) * 100}%)`;
                });

                snackPrevBtn.disabled = (currentSnackIndex === 0);
                snackNextBtn.disabled = (currentSnackIndex === groups.length - 1);
            }

            function updateDrinkUI() {
                const groups = drinkContainer.querySelectorAll('.food-group');
                groups.forEach((group, index) => {
                    group.style.transform = `translateX(${(index - currentDrinkIndex) * 100}%)`;
                });

                drinkPrevBtn.disabled = (currentDrinkIndex === 0);
                drinkNextBtn.disabled = (currentDrinkIndex === groups.length - 1);
            }


            // Chuyển đến nhóm món chính trước
            function goToPrevMainDish() {
                if (currentMainDishIndex > 0) {
                    currentMainDishIndex--;
                    updateMainDishPosition();
                }
            }

            // Chuyển đến nhóm món chính tiếp theo
            function goToNextMainDish() {
                const maxIndex = Math.ceil(mainDishes.length / 3) - 1;
                if (currentMainDishIndex < maxIndex) {
                    currentMainDishIndex++;
                    updateMainDishPosition();
                }
            }

            // Khởi tạo món ăn nhẹ
            function initSnacks() {
                snackSlide.innerHTML = '';

                // Chia món ăn thành các nhóm, mỗi nhóm tối đa 3 món
                for (let i = 0; i < snacks.length; i += 3) {
                    const group = document.createElement('div');
                    group.className = 'food-group';
                    group.style.display = 'flex';
                    group.style.width = '100%';

                    for (let j = i; j < i + 3 && j < snacks.length; j++) {
                        const snack = snacks[j];
                        const foodItem = document.createElement('div');
                        foodItem.className = 'food-item';

                        foodItem.innerHTML = `
                    <img src="${snack.image}" alt="${snack.name}">
                    <div class="food-item-name">${snack.name}</div>
                    <div class="quantity-control">
                        <button class="quantity-btn minus" data-id="${snack.id}">-</button>
                        <span class="quantity" id="snack-qty-${snack.id}">0</span>
                        <button class="quantity-btn plus" data-id="${snack.id}">+</button>
                    </div>
                `;

                        const minusBtn = foodItem.querySelector('.minus');
                        const plusBtn = foodItem.querySelector('.plus');

                        minusBtn.addEventListener('click', () => decreaseQuantity('snack', snack.id));
                        plusBtn.addEventListener('click', () => increaseQuantity('snack', snack.id, snack.name, snack.price));

                        group.appendChild(foodItem);
                    }

                    snackContainer.appendChild(group);
                }

                // Cập nhật chiều rộng slide dựa trên số nhóm
                snackSlide.style.width = `${Math.ceil(snacks.length / 3) * 100}%`;
                updateSnackPosition();
            }

            // Cập nhật vị trí món ăn nhẹ
            function updateSnackPosition() {
                const maxIndex = Math.ceil(snacks.length / 3) - 1;
                currentSnackIndex = Math.max(0, Math.min(currentSnackIndex, maxIndex));

                snackPrevBtn.disabled = currentSnackIndex === 0;
                snackNextBtn.disabled = currentSnackIndex === maxIndex;

                snackSlide.style.transform = `translateX(-${currentSnackIndex * 100}%)`;
            }

            // Chuyển đến nhóm món ăn nhẹ trước
            function goToPrevSnack() {
                if (currentSnackIndex > 0) {
                    currentSnackIndex--;
                    updateSnackPosition();
                }
            }

            // Chuyển đến nhóm món ăn nhẹ tiếp theo
            function goToNextSnack() {
                const maxIndex = Math.ceil(snacks.length / 3) - 1;
                if (currentSnackIndex < maxIndex) {
                    currentSnackIndex++;
                    updateSnackPosition();
                }
            }

            // Khởi tạo nước uống
            function initDrinks() {
                drinkSlide.innerHTML = '';
                drinkSlide.style.width = `${Math.ceil(drinks.length / 3) * 100}%`;

                drinks.forEach((drink) => {
                    const foodItem = document.createElement('div');
                    foodItem.className = 'food-item';

                    foodItem.innerHTML = `
                    <img src="${drink.image}" alt="${drink.name}">
                    <div class="food-item-name">${drink.name}</div>
                    <div class="quantity-control">
                        <button class="quantity-btn minus" data-id="${drink.id}">-</button>
                        <span class="quantity" id="drink-qty-${drink.id}">0</span>
                        <button class="quantity-btn plus" data-id="${drink.id}">+</button>
                    </div>
                `;

                    // Thêm sự kiện cho nút tăng/giảm
                    const minusBtn = foodItem.querySelector('.minus');
                    const plusBtn = foodItem.querySelector('.plus');

                    minusBtn.addEventListener('click', () => decreaseQuantity('drink', drink.id));
                    plusBtn.addEventListener('click', () => increaseQuantity('drink', drink.id, drink.name, drink.price));

                    drinkContainer.appendChild(group);
                });

                updateDrinkPosition();
            }

            // Cập nhật vị trí nước uống
            function updateDrinkPosition() {
                const maxIndex = Math.ceil(drinks.length / 3) - 1;
                currentDrinkIndex = Math.max(0, Math.min(currentDrinkIndex, maxIndex));

                drinkPrevBtn.disabled = currentDrinkIndex === 0;
                drinkNextBtn.disabled = currentDrinkIndex === maxIndex;

                drinkSlide.style.transform = `translateX(-${currentDrinkIndex * 100}%)`;
            }

            // Chuyển đến nhóm nước uống trước
            function goToPrevDrink() {
                if (currentDrinkIndex > 0) {
                    currentDrinkIndex--;
                    updateDrinkPosition();
                }
            }

            // Chuyển đến nhóm nước uống tiếp theo
            function goToNextDrink() {
                const maxIndex = Math.ceil(drinks.length / 3) - 1;
                if (currentDrinkIndex < maxIndex) {
                    currentDrinkIndex++;
                    updateDrinkPosition();
                }
            }

            // Xử lý sự kiện vuốt cho các slide food
            function handleFoodTouchStart(e, containerType) {
                window.foodStartX = e.touches[0].clientX;
                window.activeFoodContainer = containerType;
            }

            function handleFoodTouchMove(e) {
                if (!window.foodStartX || !window.activeFoodContainer) return;

                const currentX = e.touches[0].clientX;
                const diffX = currentX - window.foodStartX;
                let currentIndex, maxIndex, slide;

                switch (window.activeFoodContainer) {
                    case 'mainDish':
                        currentIndex = currentMainDishIndex;
                        maxIndex = Math.ceil(mainDishes.length / 3) - 1;
                        slide = mainDishSlide;
                        break;
                    case 'snack':
                        currentIndex = currentSnackIndex;
                        maxIndex = Math.ceil(snacks.length / 3) - 1;
                        slide = snackSlide;
                        break;
                    case 'drink':
                        currentIndex = currentDrinkIndex;
                        maxIndex = Math.ceil(drinks.length / 3) - 1;
                        slide = drinkSlide;
                        break;
                }

                // Ngăn kéo quá xa ở đầu hoặc cuối danh sách
                if ((currentIndex === 0 && diffX > 0) || (currentIndex === maxIndex && diffX < 0)) {

                }

                const translateX = -currentIndex * 100 + (diffX / 10);
                slide.style.transform = `translateX(${translateX}%)`;
            }

            function handleFoodTouchEnd(e) {
                if (!window.foodStartX || !window.activeFoodContainer) return;

                const currentX = e.changedTouches[0].clientX;
                const diffX = currentX - window.foodStartX;

                switch (window.activeFoodContainer) {
                    case 'mainDish':
                        if (diffX < -100 && currentMainDishIndex < Math.ceil(mainDishes.length / 3) - 1) {
                            goToNextMainDish();
                        } else if (diffX > 100 && currentMainDishIndex > 0) {
                            goToPrevMainDish();
                        } else {
                            updateMainDishPosition();
                        }
                        break;
                    case 'snack':
                        if (diffX < -100 && currentSnackIndex < Math.ceil(snacks.length / 3) - 1) {
                            goToNextSnack();
                        } else if (diffX > 100 && currentSnackIndex > 0) {
                            goToPrevSnack();
                        } else {
                            updateSnackPosition();
                        }
                        break;
                    case 'drink':
                        if (diffX < -50 && currentDrinkIndex < Math.ceil(drinks.length / 3) - 1) {
                            goToNextDrink();
                        } else if (diffX > 100 && currentDrinkIndex > 0) {
                            goToPrevDrink();
                        } else {
                            updateDrinkPosition();
                        }
                        break;
                }

                window.foodStartX = null;
                window.activeFoodContainer = null;
            }

            // Quản lý giỏ hàng
            function increaseQuantity(type, id, name, price) {
                // Tìm sản phẩm trong giỏ hàng
                let item = cart.find(item => item.type === type && item.id === id);

                if (item) {
                    // Nếu sản phẩm đã có trong giỏ hàng, tăng số lượng
                    item.quantity++;
                } else {
                    // Nếu chưa có, thêm sản phẩm vào giỏ hàng
                    cart.push({
                        type: type,
                        id: id,
                        name: name,
                        price: price,
                        quantity: 1
                    });
                }

                // Cập nhật hiển thị số lượng
                updateQuantityDisplay(type, id);
                // Cập nhật số lượng trên nút giỏ hàng
                updateCartCount();
            }

            function decreaseQuantity(type, id) {
                // Tìm sản phẩm trong giỏ hàng
                const itemIndex = cart.findIndex(item => item.type === type && item.id === id);

                if (itemIndex !== -1) {
                    // Nếu sản phẩm có trong giỏ hàng
                    if (cart[itemIndex].quantity > 1) {
                        // Nếu số lượng > 1, giảm số lượng
                        cart[itemIndex].quantity--;
                    } else {
                        // Nếu số lượng = 1, xóa sản phẩm khỏi giỏ hàng
                        cart.splice(itemIndex, 1);
                    }

                    // Cập nhật hiển thị số lượng
                    updateQuantityDisplay(type, id);
                    // Cập nhật số lượng trên nút giỏ hàng
                    updateCartCount();
                }
            }

            function updateQuantityDisplay(type, id) {
                // Tìm sản phẩm trong giỏ hàng
                const item = cart.find(item => item.type === type && item.id === id);
                // Lấy phần tử hiển thị số lượng
                const quantityElement = document.getElementById(`${type}-qty-${id}`);

                if (quantityElement) {
                    // Cập nhật hiển thị số lượng
                    quantityElement.textContent = item ? item.quantity : 0;
                }
            }

            function updateCartCount() {
                // Tính tổng số lượng sản phẩm trong giỏ hàng
                const totalItems = cart.reduce((total, item) => total + item.quantity, 0);
                // Cập nhật hiển thị số lượng
                cartCount.textContent = totalItems;
            }

            // Xử lý khi click vào nút giỏ hàng
            function showCart() {
                if (cart.length === 0) {
                    alert('Danh sách món ăn của bạn đang trống!');
                    return;
                }

                let totalAmount = 0;
                let cartContent = 'Danh sách món ăn của bạn:\n\n';

                cart.forEach(item => {
                    const itemTotal = item.price * item.quantity;
                    totalAmount += itemTotal;
                    cartContent += `${item.name} x ${item.quantity} = ${itemTotal.toLocaleString()} VND\n`;
                });

                cartContent += `\nTổng cộng: ${totalAmount.toLocaleString()} VND`;

                if (confirm(cartContent + '\n\nXác nhận đặt hàng?')) {
                    alert('Đặt hàng thành công! Cảm ơn bạn đã sử dụng dịch vụ của Pizza Time.');
                    // Xóa giỏ hàng
                    cart = [];
                    updateCartCount();

                    // Reset số lượng hiển thị
                    mainDishes.forEach(dish => {
                        const quantityElement = document.getElementById(`main-qty-${dish.id}`);
                        if (quantityElement) quantityElement.textContent = 0;
                    });

                    snacks.forEach(snack => {
                        const quantityElement = document.getElementById(`snack-qty-${snack.id}`);
                        if (quantityElement) quantityElement.textContent = 0;
                    });

                    drinks.forEach(drink => {
                        const quantityElement = document.getElementById(`drink-qty-${drink.id}`);
                        if (quantityElement) quantityElement.textContent = 0;
                    });
                }
            }

            // Khởi tạo ứng dụng
            function initApp() {
                initTimeline();
                initComboCards();
                initMainDishes();
                initSnacks();
                initDrinks();

                // Đăng ký sự kiện combo
                comboPrevBtn.addEventListener('click', goToPrevCombo);
                comboNextBtn.addEventListener('click', goToNextCombo);
                comboContainer.addEventListener('touchstart', handleComboTouchStart);
                comboContainer.addEventListener('touchmove', handleComboTouchMove);
                comboContainer.addEventListener('touchend', handleComboTouchEnd);





                let mainDishStartX = null;
                let snackStartX = null;
                let drinkStartX = null;

                mainDishContainer.addEventListener('touchstart', (e) => {
                    mainDishStartX = e.touches[0].clientX;
                });
                mainDishContainer.addEventListener('touchmove', (e) => {
                    if (mainDishStartX === null) return;
                    const currentX = e.touches[0].clientX;
                    const diffX = currentX - mainDishStartX;
                    const groups = mainDishContainer.querySelectorAll('.food-group');
                    groups.forEach((group, index) => {
                        group.style.transform = `translateX(${(index - currentMainDishIndex) * 100 + diffX / 10}%)`;
                    });
                });
                mainDishContainer.addEventListener('touchend', (e) => {
                    if (mainDishStartX === null) return;
                    const currentX = e.changedTouches[0].clientX;
                    const diffX = currentX - mainDishStartX;
                    const maxMainDishIndex = mainDishContainer.querySelectorAll('.food-group').length - 1;
                    if (diffX < -100 && currentMainDishIndex < maxMainDishIndex) {
                        currentMainDishIndex++;
                    } else if (diffX > 100 && currentMainDishIndex > 0) {
                        currentMainDishIndex--;
                    }
                    updateMainDishUI();
                    mainDishStartX = null;
                });

                snackContainer.addEventListener('touchstart', (e) => {
                    snackStartX = e.touches[0].clientX;
                });
                snackContainer.addEventListener('touchmove', (e) => {
                    if (snackStartX === null) return;
                    const currentX = e.touches[0].clientX;
                    const diffX = currentX - snackStartX;
                    const groups = snackContainer.querySelectorAll('.food-group');
                    groups.forEach((group, index) => {
                        group.style.transform = `translateX(${(index - currentSnackIndex) * 100 + diffX / 10}%)`;
                    });
                });
                snackContainer.addEventListener('touchend', (e) => {
                    if (snackStartX === null) return;
                    const currentX = e.changedTouches[0].clientX;
                    const diffX = currentX - snackStartX;
                    const maxSnackIndex = snackContainer.querySelectorAll('.food-group').length - 1;
                    if (diffX < -100 && currentSnackIndex < maxSnackIndex) {
                        currentSnackIndex++;
                    } else if (diffX > 100 && currentSnackIndex > 0) {
                        currentSnackIndex--;
                    }
                    updateSnackUI();
                    snackStartX = null;
                });

                drinkContainer.addEventListener('touchstart', (e) => {
                    drinkStartX = e.touches[0].clientX;
                });
                drinkContainer.addEventListener('touchmove', (e) => {
                    if (drinkStartX === null) return;
                    const currentX = e.touches[0].clientX;
                    const diffX = currentX - drinkStartX;
                    const groups = drinkContainer.querySelectorAll('.food-group');
                    groups.forEach((group, index) => {
                        group.style.transform = `translateX(${(index - currentDrinkIndex) * 100 + diffX / 10}%)`;
                    });
                });
                drinkContainer.addEventListener('touchend', (e) => {
                    if (drinkStartX === null) return;
                    const currentX = e.changedTouches[0].clientX;
                    const diffX = currentX - drinkStartX;
                    const maxDrinkIndex = drinkContainer.querySelectorAll('.food-group').length - 1;
                    if (diffX < -100 && currentDrinkIndex < maxDrinkIndex) {
                        currentDrinkIndex++;
                    } else if (diffX > 100 && currentDrinkIndex > 0) {
                        currentDrinkIndex--;
                    }
                    updateDrinkUI();
                    drinkStartX = null;
                });










                // Đăng ký sự kiện giỏ hàng
                document.getElementById('cartBtn').addEventListener('click', showCart);
            }

            // Khởi tạo ứng dụng
            initApp();
        });

    </script>
</body>
</html>